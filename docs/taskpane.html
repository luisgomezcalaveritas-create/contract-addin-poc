<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Contract Drafting PoC</title>

  <!-- Office.js from Microsoft CDN -->
  <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js"></script>

  <style>
    body { font-family: Arial, sans-serif; margin: 12px; color:#111; background:#fff; }
    h3 { margin: 0 0 10px 0; font-size: 16px; }

    .banner {
      padding: 10px;
      border-radius: 8px;
      background: linear-gradient(180deg, #f8f8f8, #fff);
      border: 1px solid #e6e6e6;
      box-shadow: 0 1px 0 rgba(0,0,0,0.02);
      margin-bottom: 12px;
    }

    .small { font-size: 12px; color: #666; line-height: 1.35; }
    .ok { color: #0b6a0b; font-weight: 600; }
    .warn { color: #9a6b00; font-weight: 600; }
    .err { color: #b00020; font-weight: 600; }

    label { display:block; font-size: 12px; color:#444; margin: 10px 0 6px; }
    input[type="text"] { width:100%; padding:8px; box-sizing:border-box; border:1px solid #ddd; border-radius:8px; outline:none; }
    input[type="text"]:focus { border-color:#999; }

    ul { list-style:none; padding:0; margin:10px 0 0; border:1px solid #ddd; border-radius:8px; max-height:320px; overflow:auto; background:#fff; }
    li { padding:10px; border-bottom:1px solid #eee; cursor:pointer; }
    li:last-child { border-bottom:none; }
    li:hover { background:#f8f8f8; }
    .meta { color:#666; font-size:12px; margin-top:4px; line-height:1.3; }

    .pill { display:inline-block; font-size:11px; padding:2px 8px; border-radius:999px; background:#eee; margin-left:6px; vertical-align:middle; }
    .pill.ok { background:#e7f5e7; color:#0b6a0b; }
    .pill.warn { background:#fff4dd; color:#9a6b00; }

    .row { display:flex; gap:8px; margin-top:10px; }
    button { flex:1; padding:10px; font-size:14px; cursor:pointer; border:1px solid #ddd; border-radius:8px; background:#fff; }
    button:hover { background:#f7f7f7; }
    button:disabled { opacity:.6; cursor:not-allowed; }

    :root{
      --adobe-accent: #fa0f00;

      --badge-neutral-bg: #ededed;
      --badge-neutral-fg: #333;

      --badge-positive-bg: #e6f4ea;
      --badge-positive-fg: #137333;

      --badge-info-bg: #e8f0fe;
      --badge-info-fg: #1a73e8;

      --badge-notice-bg: #fff4dd;
      --badge-notice-fg: #9a6b00;

      --badge-negative-bg: #fde7e9;
      --badge-negative-fg: #b00020;
    }

    .status2{
      display:flex;
      align-items:center;
      gap:8px;
      margin-top:6px;
    }

    .badge{
      display:inline-flex;
      align-items:center;
      padding:2px 8px;
      border-radius:999px;
      font-size:11px;
      font-weight:600;
      border:1px solid rgba(0,0,0,0.06);
      white-space:nowrap;
    }

    .badge--neutral  { background: var(--badge-neutral-bg);  color: var(--badge-neutral-fg); }
    .badge--positive { background: var(--badge-positive-bg); color: var(--badge-positive-fg); }
    .badge--info     { background: var(--badge-info-bg);     color: var(--badge-info-fg); }
    .badge--notice   { background: var(--badge-notice-bg);   color: var(--badge-notice-fg); }
    .badge--negative { background: var(--badge-negative-bg); color: var(--badge-negative-fg); }

    button.primary{
      border-color: rgba(250,15,0,0.25);
      box-shadow: inset 0 0 0 1px rgba(250,15,0,0.12);
    }
    button.primary:hover{
      box-shadow: inset 0 0 0 2px rgba(250,15,0,0.18);
    }

    .hint {
      margin-top:10px;
      font-size:12px;
      color:#555;
      background:#fafafa;
      border:1px dashed #e3e3e3;
      border-left:3px solid var(--adobe-accent);
      border-radius:8px;
      padding:8px;
      line-height:1.35;
    }

    .kbd { font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", monospace;
           font-size:11px; border:1px solid #ddd; border-bottom-width:2px; padding:1px 6px; border-radius:4px; background:#fff; }
  </style>
</head>

<body>
  <h3>Contract Drafting PoC</h3>

  <div class="banner" role="status" aria-live="polite" aria-atomic="true">
    <div id="status" class="small">Loading…</div>

    <div id="status2" class="small status2" aria-live="polite" aria-atomic="true">
      <span id="statusBadge" class="badge badge--neutral">Initializing</span>
      <span id="statusText">Loading…</span>
    </div>
  </div>

  <label for="search">Search legal playbook clauses</label>
  <input id="search" type="text"
         placeholder="Search by title, id, tags… (e.g., nda, risk, term, payment)"
         disabled />

  <ul id="results" aria-label="Clause results list"></ul>

  <div class="row">
    <button id="btnValidate" class="primary" disabled>Validate (Track Changes overlay)</button>
    <button id="btnReset" disabled>Reset (Clear highlights)</button>
  </div>

  <div class="hint">
    <b>Demo:</b> Click a clause to insert → edit text → click <span class="kbd">Validate</span>.<br/>
    <b>Reset</b> clears traffic-light highlights applied during validation.
  </div>

  <!-- SINGLE source-of-truth for build version -->
  <script>
    window.BUILD_VERSION = "1.0.0.4";
    const s = document.createElement("script");
    s.src = "./taskpane.js?v=" + encodeURIComponent(window.BUILD_VERSION);
    s.defer = true;
    document.body.appendChild(s);
  </script>
</body>
</html>
``
